(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1750],{3437:(e,t,s)=>{"use strict";function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e," online")}s.d(t,{w:()=>i})},6181:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var i=s(6379),n=s(94907),a=s(97587);function o(e){let{children:t}=e,[s,o]=(0,n.useState)({visible:!1,props:{}}),r=(0,n.useMemo)(()=>({value:s,setValue:o}),[s,o]);return(0,i.jsx)(a.C,{value:r,children:t})}},16983:(e,t,s)=>{"use strict";s.d(t,{_:()=>i,o:()=>n});var i=function(e){return e.PING="ping",e.RTT="delay",e.QUEUE="queue",e.CANCEL="cancel",e.PAUSE="pause",e}({}),n=function(e){return e[e["太多请求"]=8e3]="太多请求",e[e["重复连接"]=8001]="重复连接",e[e["没有更多设备"]=8002]="没有更多设备",e[e["长时间没有控制"]=8003]="长时间没有控制",e[e["连接断开"]=8004]="连接断开",e[e["连接错误"]=8005]="连接错误",e[e["设备过期"]=8006]="设备过期",e[e["游戏不存在"]=8007]="游戏不存在",e[e["游戏ID错误"]=8008]="游戏ID错误",e[e["游戏ID为空"]=8009]="游戏ID为空",e[e["用户Token错误"]=8010]="用户Token错误",e[e["排队信息"]=8011]="排队信息",e[e["游戏暂停"]=8012]="游戏暂停",e[e["用户ID错误"]=8013]="用户ID错误",e[e["用户Token为空"]=8014]="用户Token为空",e[e["没有更多使用时间"]=8015]="没有更多使用时间",e[e["添加游戏时间"]=8018]="添加游戏时间",e[e["已分配设备并结束排队"]=8023]="已分配设备并结束排队",e[e["心跳"]=200]="心跳",e[e["设备信息"]=8888]="设备信息",e[e["关闭"]=886]="关闭",e}({})},16990:(e,t,s)=>{"use strict";s.d(t,{a:()=>i});let i=(0,s(94907).createContext)({tapFullscreen:()=>{},loadingAds:!1,pageFullscreen:!1})},22308:(e,t,s)=>{var i={"./Code":[34015,4015],"./Code.json":[34015,4015],"./ar_IL":[22413,2413],"./ar_IL.json":[22413,2413],"./de_DE":[3599,3599],"./de_DE.json":[3599,3599],"./en_US":[9864,9864],"./en_US.json":[9864,9864],"./es_ES":[40289,289],"./es_ES.json":[40289,289],"./fr_FR":[49209,9209],"./fr_FR.json":[49209,9209],"./in_ID":[96425,6425],"./in_ID.json":[96425,6425],"./ja_JP":[31556,1556],"./ja_JP.json":[31556,1556],"./ko_KR":[45774,5774],"./ko_KR.json":[45774,5774],"./pt_PT":[78573,8573],"./pt_PT.json":[78573,8573],"./ru_RU":[84283,4283],"./ru_RU.json":[84283,4283],"./th_TH":[18381,8381],"./th_TH.json":[18381,8381],"./vi_VN":[99182,9182],"./vi_VN.json":[99182,9182],"./zh_CN":[98734,8734],"./zh_CN.json":[98734,8734],"./zh_TW":[39670,9670],"./zh_TW.json":[39670,9670]};function n(e){if(!s.o(i,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=i[e],n=t[0];return s.e(t[1]).then(()=>s.t(n,19))}n.keys=()=>Object.keys(i),n.id=22308,e.exports=n},32994:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var i=s(6379);let n=(0,s(1670).default)(()=>Promise.all([s.e(5690),s.e(7207),s.e(6341),s.e(8821),s.e(3489),s.e(2752),s.e(7016)]).then(s.bind(s,2739)),{loadableGenerated:{webpack:()=>[2739]},ssr:!1});function a(){return(0,i.jsx)("div",{className:"h-13 w-60 of-hidden rd-full bg-cyan-5 p-0","lt-sm":"h-10 w-50",children:(0,i.jsx)(n,{})})}},36894:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var i=s(6379);let n=(0,s(1670).default)(()=>s.e(6859).then(s.bind(s,76859)),{loadableGenerated:{webpack:()=>[76859]},ssr:!1});function a(){return(0,i.jsx)(n,{})}},39910:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var i=s(6379),n=s(42305),a=s(55247),o=s(64510),r=s(68878);function c(e){let{children:t,className:s,...c}=e,l=(0,a.useAtomValue)(o.n6)!==r.fJ.游玩;return(0,i.jsx)("div",{className:(0,n.A)(s,l?"block":"hidden"),...c,children:t})}},40480:(e,t,s)=>{"use strict";function i(e,t){return new Promise((s,i)=>{if(document.querySelector('script[src="'.concat(e,'"]')))return void s(!0);let n=document.createElement("script");null==t||t.map(e=>n.setAttribute(e.name,e.value)),n.src=e,n.onload=s,n.onerror=i,document.head.appendChild(n)})}s.d(t,{Hd:()=>o,sz:()=>i}),s(6897);let n=null;async function a(){n||(n=(await s.e(1903).then(s.bind(s,1903))).load());let e=await n;return(await e.get()).visitorId}async function o(){try{let e=localStorage.getItem("EASYFUN_FINGER_PRINT");if(e)return e;let t=await a();return localStorage.setItem("EASYFUN_FINGER_PRINT",t),t}catch(e){console.error(e)}}},54644:(e,t,s)=>{"use strict";s.d(t,{Pf:()=>a,Vk:()=>i,e6:()=>n,k3:()=>o});var i=function(e){return e[e.LOGIN=0]="LOGIN",e[e.SIGNUP=1]="SIGNUP",e[e.RESET=2]="RESET",e}({}),n=function(e){return e[e.REGISTER=1]="REGISTER",e[e.EMAIL=2]="EMAIL",e[e.GOOGLE=3]="GOOGLE",e[e.GOOGLE_ONE_TAP=4]="GOOGLE_ONE_TAP",e}({}),a=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.GAME_DETAIL_VISITOR_PLAY_BTN=1]="GAME_DETAIL_VISITOR_PLAY_BTN",e[e.GOOGLE_ONE_TAP=2]="GOOGLE_ONE_TAP",e[e.NAV_ICON=3]="NAV_ICON",e[e.GAME_PANEL_TIPS_BAR_BTN=4]="GAME_PANEL_TIPS_BAR_BTN",e[e.QUEUE_POPUP_BTN=5]="QUEUE_POPUP_BTN",e[e.TIME_EXPIRED_POPUP=6]="TIME_EXPIRED_POPUP",e[e.CLOUD_GAME_USER_INFO=7]="CLOUD_GAME_USER_INFO",e}({}),o=function(e){return e[e["第三方内嵌"]=0]="第三方内嵌",e[e["EXE内嵌"]=1]="EXE内嵌",e[e["默认"]=-1]="默认",e[e.EEmbedChannel=0]="EEmbedChannel",e}({})},64405:(e,t,s)=>{"use strict";s.d(t,{default:()=>g});var i=s(6379),n=s(1670),a=s(75909),o=s(55247),r=s(2285),c=s(94907),l=s(56625),u=s(40480),d=s(84459),h=s(64510),f=s(68878),p=s(16990);function m(e){let{children:t}=e,{isIOS:s}=(0,d.Y)(),[n,m]=(0,o.useAtom)(h.Gl),v=(0,c.useMemo)(()=>s&&n.fullscreen,[s,n]),[E,{enterFullscreen:g,exitFullscreen:y,toggleFullscreen:w}]=(0,a.A)(()=>document.getElementById("fullscreen-element")),[S,b]=(0,c.useState)(!1);(0,c.useEffect)(()=>{m(e=>({...e,fullscreen:E||S}))},[E,S]);let I=(0,o.useAtomValue)(h.n6);(0,c.useEffect)(()=>{I===f.fJ.空闲&&(E&&y(),S&&b(!1))},[I]);let{preViewAdsTime:_,updateIntervalTime:O}=function(e){let[t,s]=(0,l.A)("MwU92MD4slarNjdgil3boe",{defaultValue:{}});return{preViewAdsTime:(0,c.useMemo)(()=>(null==t?void 0:t[e])||0,[t,e]),updateIntervalTime:function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18e5;s({...t,[e]:Date.now()+i})}}}((0,o.useAtomValue)(h.vB).id),{initAds:T,startLoadAds:L,loadingAds:A}=function(e,t){let{onSuccess:s,onSkip:i}=t,n=(0,c.useRef)(!1),[a,o]=(0,c.useState)(!1);function r(e){o(!1),n.current=!1,e.makeRewardedVisible()}function l(){null==s||s()}function d(e){(window.googletag||{}).destroySlots([e.rewardedSlot])}function h(e){setTimeout(()=>{n.current||(o(!1),null==i||i())},e)}return{initAds:async function e(){try{await (0,u.sz)("https://securepubads.g.doubleclick.net/tag/js/gpt.js"),window.stpd=window.stpd||{que:[]}}catch(e){}},startLoadAds:function(){if(o(!0),n.current=!1,window.googletag){h(3e3);let t=window.googletag||{};t.cmd=t.cmd||[],t.cmd.push(()=>{let s=t.defineOutOfPageSlot(e,t.enums.OutOfPageFormat.REWARDED);s&&s.addService(t.pubads()),t.enableServices(),t.pubads().addEventListener("rewardedSlotReady",r),t.pubads().addEventListener("rewardedSlotClosed",d),t.pubads().addEventListener("rewardedSlotGranted",l),t.display(s)})}else h(2e3)},loadingAds:a}}("/22857857566/easyfun.gg_rewarded",{onSuccess:()=>{O(6e4),g()},onSkip:()=>{O()}}),N=(0,r.yF)(e=>{let{fullscreen:t}=e(h.Gl);Date.now()>=_&&!t?L():s?b(e=>!e):w()});(0,c.useEffect)(()=>{T()},[]);let C=(0,c.useMemo)(()=>({tapFullscreen:N,loadingAds:A,pageFullscreen:v}),[N,A,v]);return(0,i.jsx)(p.a,{value:C,children:t})}let v=(0,n.default)(()=>Promise.all([s.e(3944),s.e(8090),s.e(1369),s.e(8821),s.e(4740)]).then(s.bind(s,24740)),{loadableGenerated:{webpack:()=>[24740]},ssr:!1,loading:()=>(0,i.jsx)("div",{id:"fullscreen-element",className:"cloud-game-screen-gui relative size-full of-hidden","lt-sm":"aspect-9/16","un-sm":"aspect-16/9 rd-t-3"})}),E=(0,n.default)(()=>Promise.all([s.e(5690),s.e(8090),s.e(7207),s.e(6341),s.e(7602),s.e(9723),s.e(7464),s.e(5006)]).then(s.bind(s,95954)),{loadableGenerated:{webpack:()=>[95954]},ssr:!1});function g(e){let{className:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(m,{children:[(0,i.jsx)(v,{className:t}),(0,i.jsx)(E,{})]})})}},64510:(e,t,s)=>{"use strict";s.d(t,{BM:()=>O,C8:()=>S,CN:()=>I,Gl:()=>b,Lp:()=>y,Qp:()=>E,X0:()=>g,Zm:()=>l,ee:()=>c,h1:()=>p,h4:()=>_,i7:()=>w,ii:()=>d,n6:()=>h,o2:()=>u,v0:()=>v,vB:()=>f,x4:()=>m});var i=s(64299),n=s(91577),a=s(68878),o=s(54644),r=s(76518);let c=(0,i.eU)(o.k3.默认),l=(0,i.eU)(!1),u=(0,i.eU)(0),d=(0,i.eU)({start:()=>{},done:()=>{},stop:()=>{}}),h=(0,i.eU)(a.fJ.空闲),f=(0,i.eU)({}),p=(0,i.eU)([]),m=(0,i.eU)({announcement:"",isInDowntime:!1,waitDowntimeMin:0}),v=(0,i.eU)({token:"",uid:"",fingerprint:"",gameId:"",platform:""}),E=(0,i.eU)({gameId:"",businessWssLink:"",isReconnect:!1}),g=(0,i.eU)({gameId:"",isReconnect:!1,device:{}}),y=(0,i.eU)({businessWss:{},wss:{},rtc:{},control:{}}),w=(0,n.tG)("EASYFUN_IS_MUTED",!1,void 0,{getOnInit:!0}),S=(0,n.tG)("EASYFUN_VIDEO_QUALITY",r.W8["360P"],void 0,{getOnInit:!0}),b=(0,i.eU)({fullscreen:!1,horizontal:!1,mobile:!1}),I=(0,i.eU)({gameId:0,uid:"",token:""}),_=(0,i.eU)({isShowPresetKeyGUI:!1,status:a.n.HIDE,mousePanel:void 0}),O=(0,i.eU)({isOpen:!1,isTouching:!1,ref:null})},68878:(e,t,s)=>{"use strict";s.d(t,{Kw:()=>o,X2:()=>i,Xe:()=>n,fJ:()=>a,n:()=>r});var i=function(e){return e[e["关闭弹窗"]=0]="关闭弹窗",e[e["服务器位置提示"]=1]="服务器位置提示",e[e["长时间未活跃"]=2]="长时间未活跃",e[e["重复连接"]=3]="重复连接",e[e["排队信息"]=4]="排队信息",e[e["免费时长用尽"]=5]="免费时长用尽",e[e["时长已用尽"]=6]="时长已用尽",e[e["提醒更换浏览器"]=7]="提醒更换浏览器",e[e["服务器维护中"]=8]="服务器维护中",e[e["检查退出"]=9]="检查退出",e}({}),n=function(e){return e[e["云游"]=1]="云游",e[e["页游"]=2]="页游",e}({}),a=function(e){return e["空闲"]="IDLE",e["加载"]="LOADING",e["排队"]="QUEUE",e["游玩"]="PLAYING",e["开始"]="START",e["异常"]="ERROR",e}({}),o=function(e){return e[e["游客"]=1]="游客",e[e["登录"]=2]="登录",e}({}),r=function(e){return e.EDIT="EDIT",e.ADD="ADD",e.HIDE="HIDE",e.SHOW="SHOW",e}({})},70557:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var i=s(6379);let n=(0,s(1670).default)(()=>s.e(1018).then(s.bind(s,11018)),{loadableGenerated:{webpack:()=>[11018]},ssr:!1,loading:()=>(0,i.jsx)("div",{className:"h-8"})});function a(e){let{packageName:t,saveProcess:s,guestDisallow:a}=e;return!!t&&(0,i.jsx)(n,{packageName:t,saveProcess:s,guestDisallow:a})}},74699:(e,t,s)=>{"use strict";s.d(t,{C:()=>n});var i=s(78426);function n(e){let t={name:e.name,packageName:e.packageName,iconUrl:e.iconUrl,collectionItem:e.collectionItem},s={getAppInfoFull:()=>(e.appInfo&&(t.appInfo=e.appInfo),s),getAppInfoLite(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.appInfo&&(t.appInfo=(0,i.U)(e.appInfo,["name","iconUrl","seoUrl","rating","desc","id",...n])),s},getAdsInfoFull:()=>(e.adsInfo&&(t.adsInfo=e.adsInfo),s),getAdsInfoLite(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.adsInfo&&(t.adsInfo=(0,i.U)(e.adsInfo,["titleName","iconUrl","offerId",...n])),s},getEasyfunInfoFull:()=>(e.easyfunGame&&(t.easyfunGame=e.easyfunGame),s),getEasyfunInfoLite(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.easyfunGame&&(t.easyfunGame=(0,i.U)(e.easyfunGame,["gameName","icon","seo","category","banner","id",...n])),s},pick:i.U,value:()=>t};return s}},76518:(e,t,s)=>{"use strict";s.d(t,{bB:()=>b,Kq:()=>y,je:()=>S,ee:()=>I,L6:()=>a,W8:()=>f,LJ:()=>u,_5:()=>h,Sq:()=>M,UO:()=>m,gm:()=>E,jU:()=>x,G8:()=>T,i4:()=>P});let i=JSON.parse('{"hwsg1.ldcloud.net":"111.119.225.249","port-sg.ldcloud.net":"119.13.169.247"}');class n{effect(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach(t=>{let i=this.effectList.get(t)||[];this.effectList.set(t,[...i,{callback:e,needEventName:s}])})}hookEvent(e,t){(this.effectList.get(e)||[]).forEach(s=>{s.needEventName?s.callback(t,e):s.callback(t)})}clearEffectList(){this.effectList=new Map}constructor(){this.effectList=new Map}}var a=function(e){return e.STREAM="stream",e.DATA_CHANNEL_OPEN="data_channel_open",e.DATA_CHANNEL_MESSAGE="data_channel_message",e.RTT="rtt",e.CANDIDATE="candidate",e.STATUS_DATA="status_data",e.NETWORK_ERROR="network_error",e}({}),o=function(e){return e.CLIENT="1",e}({}),r=function(e){return e.TOUCH="_touch2",e.MOVE="_move",e.INPUT="_text",e.SYSTEM_KEY="_key",e}({}),c=function(e){return e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HD=2]="HD",e[e.FULL_HD=3]="FULL_HD",e}({}),l=function(e){return e[e.MOBILE=1]="MOBILE",e[e.PC=0]="PC",e}({}),u=function(e){return e.JOIN="_join",e.OFFER="_offer",e.CANDIDATE="_candidate",e.PING="_ping",e.FORCEI="_forceI",e.AUDIO_MUTE="_audio_mute",e.SWITCH_QUALITY="_switch_quality",e.RTC_INIT="_rtc_init",e.WSS_CLOSE="_wss_close",e}({}),d=function(e){return e.CLIENT="1",e.SERVER="2",e}({}),h=function(e){return e.JOIN_RES="_join_res",e.ANSWER="_answer",e.NOTIFY="_notify",e.INPUT_STATUS="_transmit",e}({}),f=function(e){return e[e["360P"]=0]="360P",e[e["480P"]=1]="480P",e[e["720P"]=2]="720P",e[e["1080P"]=3]="1080P",e}({});class p extends n{init(){this.rtc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]}),this.rtc.addTransceiver("video",{direction:"recvonly"}),this.rtc.addTransceiver("audio",{direction:"recvonly"}),this.listenStream(),this.initDataChannel(),this.interval&&clearInterval(this.interval),this.interval=setInterval(this.getRtcStatus.bind(this),2e3),this.listenIceCandidate()}listenStream(){this.rtc&&(this.rtc.addEventListener("track",e=>{this.hookEvent(a.STREAM,e.streams[0])}),this.rtc.addEventListener("addstream",e=>{this.hookEvent(a.STREAM,e.stream)}),this.rtc.addEventListener("addtrack",e=>{this.hookEvent(a.STREAM,e)}))}listenIceCandidate(){this.rtc&&this.rtc.addEventListener("icecandidate",e=>{e.candidate&&!this.isEffectedIceCandidate&&(this.isEffectedIceCandidate=!0,this.hookEvent(a.CANDIDATE,e.candidate),this.wsSend(u.CANDIDATE,e.candidate))})}initDataChannel(){this.rtc&&(this.dataChannel=this.rtc.createDataChannel("MessageChannel",{ordered:!0}),this.dataChannel.onopen=e=>{this.hookEvent(a.DATA_CHANNEL_OPEN,e),this.getRtcStatus()})}async createOffer(){if(!this.rtc)return;let e=await this.rtc.createOffer();return await this.rtc.setLocalDescription(e),e}async setRemoteDescription(e,t){this.rtc&&e.sdp&&(e.sdp=function(e,t,s){let n=e.split("\r\n").filter(e=>!e.includes("msid:zlmediakit-mslabel zlmediakit-label")).join("\r\n"),a=i[t]||t;return n.replace(/(candidate:\S+ \d+ (udp|tcp) \d+ )([0-9.]+) (\d+)(.*)/g,"$1".concat(a," ").concat(s,"$5"))}(e.sdp,t.ip,t.port),await this.rtc.setRemoteDescription(e))}async getRtcStatus(){if(this.rtc)if((await this.rtc.getStats()).forEach(e=>{Object.keys(e).forEach(t=>{if("currentRoundTripTime"===t){let t=1e3*e.currentRoundTripTime;this.hookEvent(a.RTT,t),this.prevRtt=t}}),e.jitter&&"video"===e.kind&&(this.hookEvent(a.STATUS_DATA,e),this.wsSend(u.PING,e))}),0!==this.prevUpdateStream&&new Date-this.prevUpdateStream>8e3){if(console.warn("video stopppppppppppppppppppppppppppppppppppped"),this.wsSend(u.FORCEI,{}),this.videoForcei+=1,this.videoForcei>=10){this.hookEvent(a.NETWORK_ERROR,{});try{window.__bl.sum("connect-rtc-error",1)}catch(e){}}}else this.videoForcei=0}videoUpdateTimeout(){this.prevUpdateStream=+new Date}dataChannelSend(e,t){this.dataChannel&&"open"===this.dataChannel.readyState&&this.dataChannel.send(JSON.stringify({eventType:o.CLIENT,eventName:e,data:t}))}addCandidate(e){if(!this.rtc)return;let t=new RTCIceCandidate({sdpMid:"0",sdpMLineIndex:0,candidate:e});this.rtc.addIceCandidate(t).catch(()=>{try{window.__bl.sum("add-ice-candidate-error",1),window.__bl.error(Error("RTC addIceCandidate Error"))}catch(e){}})}getLastRtt(){return this.prevRtt}close(){var e;null==(e=this.rtc)||e.close(),this.prevUpdateStream=0,this.interval&&clearInterval(this.interval)}constructor(e,t){super(),this.isEffectedIceCandidate=!1,this.interval=null,this.rtc=null,this.dataChannel=null,this.prevUpdateStream=0,this.videoForcei=0,this.prevRtt=0,this.wsSend=e,this.wsEffect=t}}function m(e,t){let s=new p(e,t);return{getRTCInstance:()=>s.rtc,close:s.close.bind(s),init:s.init.bind(s),effect:s.effect.bind(s),createOffer:s.createOffer.bind(s),dataChannelSend:s.dataChannelSend.bind(s),videoUpdateTimeout:s.videoUpdateTimeout.bind(s),setRemoteDescription:s.setRemoteDescription.bind(s),addCandidate:s.addCandidate.bind(s),getLastRtt:s.getLastRtt.bind(s),clearEffectList:s.clearEffectList.bind(s)}}class v extends n{setParams(e){return this.url=e.url,this}connect(){return new Promise((e,t)=>{this.ws=new WebSocket(this.url),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{e(this.ws),this.ws&&(this.ws.onmessage=e=>{let t=JSON.parse(e.data);this.hookEvent(t.eventName,t)},this.ws.onerror=t)},this.ws.onclose=()=>{this.hookEvent(u.WSS_CLOSE,{}),this.clearEffectList(),console.log("backend device wss close")},this.ws.onerror=e=>{console.log("backend device wss error",e)}})}send(e,t){var s;null==(s=this.ws)||s.send(JSON.stringify({eventType:d.CLIENT,eventName:e,data:t}))}close(){var e;null==(e=this.ws)||e.close(),console.log("frontend device wss close")}constructor(...e){super(...e),this.ws=null,this.url=""}}function E(){let e=new v;return{getWSInstance:()=>e.ws,close:e.close.bind(e),send:e.send.bind(e),setParams:e.setParams.bind(e),connect:e.connect.bind(e),effect:e.effect.bind(e),clearEffectList:e.clearEffectList.bind(e),hookEvent:e.hookEvent.bind(e)}}var g=s(24057),y=function(e){return e.MULTI_TOUCH="multi_touch",e.MOVE="move",e.CONTROL_RECT_RESIZE="control_rect_resize",e.PRESET_KEYBOARD_DOWN="preset_keyboard_down",e.PRESET_KEYBOARD_UP="preset_keyboard_up",e.KEYBOARD_DOWN="keyboard_down",e.KEYBOARD_UP="keyboard_up",e.KEYBOARD_DATA_UPDATE="keyboard_data_update",e.TOGGLE_SCREEN_FOLLOW_SCREEN_STATUS="toggle_screen_follow_screen_status",e}({}),w=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=2]="UP",e}({}),S=function(e){return e.HOME="0",e.MENU="1",e.BACK="2",e.VOLUME_ADD="3",e.VOLUME_SUB="4",e.DELETE="5",e.ENTER="6",e}({}),b=function(e){return e[e.UP=0]="UP",e[e.LEFT=1]="LEFT",e[e.DOWN=2]="DOWN",e[e.RIGHT=3]="RIGHT",e}({}),I=function(e){return e[e.TOUCH=0]="TOUCH",e[e.COMPASS=1]="COMPASS",e[e.ZOOM=2]="ZOOM",e[e.ROTATION=3]="ROTATION",e}({}),_=function(e){return e[e.DOWN=0]="DOWN",e[e.MOVE=1]="MOVE",e[e.UP=2]="UP",e[e.MOVE_END_UP=3]="MOVE_END_UP",e[e.DOWN_IN_MOVE=4]="DOWN_IN_MOVE",e[e.UP_IN_MOVE=5]="UP_IN_MOVE",e}({}),O=function(e){return e[e.PORTRAIT=0]="PORTRAIT",e[e.LANDSCAPE=1]="LANDSCAPE",e}({});function T(){var e,t;let s=!1;return t=navigator.userAgent||navigator.vendor||(null==(e=window)?void 0:e.opera),(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([\- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([\- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[23]|n30(0|2)|n50([025])|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8c]))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([\-01])|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4)))&&(s=!0),s}function L(e){let t=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},s=t()+t();if(e)for(;void 0!==e[s];)s=t()+t();return s}function A(e,t,s,i){return{x:Math.round(e/s*1e3),y:Math.round(t/i*1e3)}}function N(e,t,s,i){let{left:n,top:a,width:o,height:r}=s,{x:c,y:l}=A(Math.round(e-n),Math.round(t-a),o,r);return i?{x:Math.abs(l-1e3),y:c}:{x:c,y:l}}function C(e,t,s){let i=[];if(e.type.includes("touch")){"touchstart"===e.type&&e.preventDefault();let n="touchend"===e.type?e.changedTouches:e.touches;if(n.length)for(let e=0;e<n.length;e++){let a=n[e].clientX,o=n[e].clientY;i.push({id:n[e].identifier,...N(a,o,t,s)})}}else{let n=e.clientX,a=e.clientY;i.push({id:0,...N(n,a,t,s)})}return i}function D(e,t,s,i,n,a){let o=a?Math.abs(s-1e3):t,r=Math.round(e/2),c=Math.round(e/(a?n/i:i/n)/2);return{deviceYRadius:r,deviceXRadius:c,centerX:o+(a?-c:r),centerY:(a?t:s)+(a?e:r)/2}}let k=["escape","space","enter","shift","alt","tab","control","`"],U={escape:["Escape"],space:["Space"],enter:["Enter","NumpadEnter"],shift:["ShiftLeft","ShiftRight"],alt:["AltLeft","AltRight"],tab:["Tab"],control:["ControlLeft","ControlRight"],"`":["Backquote"]};function P(e,t){let s={interactive:{},logic:{}},i=JSON.parse(e);if(null==i?void 0:i.logic)return i;let n=(t===O.PORTRAIT?272:856)/1e3;return Object.keys(i).forEach(e=>{let t=i[e],a=e.split("___")[1],o="Key".concat(a.toUpperCase());if("wasd"===a){let e=s.logic.KeyW||[],i=s.logic.KeyA||[],a=s.logic.KeyS||[],o=s.logic.KeyD||[],r=L(s.interactive);s.interactive[r]={code:["KeyW","KeyA","KeyS","KeyD"],width:t.size/n,height:t.size/n,x:t.left,y:t.top,name:{[b.UP]:"W",[b.LEFT]:"A",[b.DOWN]:"S",[b.RIGHT]:"D"},zIndex:1,type:I.COMPASS},s.logic.KeyW=[...e,{patch:I.COMPASS,direction:b.UP,interactive:r}],s.logic.KeyA=[...i,{patch:I.COMPASS,direction:b.LEFT,interactive:r}],s.logic.KeyS=[...a,{patch:I.COMPASS,direction:b.DOWN,interactive:r}],s.logic.KeyD=[...o,{patch:I.COMPASS,direction:b.RIGHT,interactive:r}]}else if(Number.isNaN(Number(a)))if(k.includes(a.toLocaleLowerCase()))U[a.toLocaleLowerCase()].forEach(e=>{let i=s.logic[e]||[],a=L(s.interactive);s.interactive[a]={code:[e],width:40/n,height:40/n,x:t.left,y:t.top,name:e,zIndex:1,type:I.TOUCH},s.logic[e]=[...i,{patch:I.TOUCH,interactive:a}]});else{let e=s.logic[o]||[],i=L(s.interactive);s.interactive[i]={code:[o],width:40/n,height:40/n,x:t.left,y:t.top,name:a,zIndex:1,type:I.TOUCH},s.logic[o]=[...e,{patch:I.TOUCH,interactive:i}]}else{let e="Digit".concat(a),i="Numpad".concat(a),o=s.logic[e]||[],r=s.logic[i]||[],c=L(s.interactive);s.interactive[c]={code:[e],width:40/n,height:40/n,x:t.left,y:t.top,name:e,zIndex:1,type:I.TOUCH};let l=L(s.interactive);s.interactive[l]={code:[i],width:40/n,height:40/n,x:t.left,y:t.top,name:i,zIndex:1,type:I.TOUCH},s.logic[e]=[...o,{patch:I.TOUCH,interactive:c}],s.logic[i]=[...r,{patch:I.TOUCH,interactive:l}]}}),s}class R extends n{getStatusInfo(){return(0,g.m)(this.status)}getVideoRect(){return this.rect}listenerToggleInputStatus(){this.wsEffect(e=>{try{var t,s;let i=JSON.parse(e.data);this.status.isInputStatus=i.IMEIsActive,this.status.isInputStatus?(this.inputStatusKeyboardElement||this.initInputElement(),null==(t=this.inputStatusKeyboardElement)||t.focus()):(null==(s=this.inputStatusKeyboardElement)||s.remove(),this.inputStatusKeyboardElement=null)}catch(e){}},[h.INPUT_STATUS])}consumeLocusData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(this.status.isFreezeControl)return;let{status:s,x:i,y:n}=t;switch(s){case _.DOWN:if(!this.locusList.size){let t=e.startsWith("touch-")&&!this.activeKeyMap.size,s=1===this.activeKeyMap.size;if(t||s){this.dataChannelSend(r.TOUCH,{type:w.DOWN,x:i,y:n});break}}this.consumeLocusData(e,{x:i,y:n,status:_.MOVE});break;case _.MOVE:{let t=[];e&&this.locusList.set(e,{x:i,y:n,status:_.MOVE}),this.locusList.forEach(e=>{e.status===_.MOVE&&t.push({x:e.x,y:e.y,id:t.length})}),this.dataChannelSend(r.MOVE,t);break}case _.UP:this.locusList.delete(e),this.activeKeyMap.delete(e),this.activeKeyMap.size||this.locusList.size?this.consumeLocusData("",{status:_.MOVE,x:0,y:0}):this.dataChannelSend(r.TOUCH,{type:w.UP,x:i,y:n})}}initInputElement(){var e;this.inputStatusKeyboardElement=document.createElement("input"),this.inputStatusKeyboardElement.setAttribute("type","text"),this.inputStatusKeyboardElement.setAttribute("id","abcdefg"),this.inputStatusKeyboardElement.setAttribute("style","position: fixed; top: -1000px; left: 0; opacity: 0; z-index: -10; pointer-event: none;"),this.inputStatusKeyboardElement.addEventListener("input",e=>{(null==e?void 0:e.inputType)!=="insertFromPaste"&&this.handleTextInput(e)}),this.inputStatusKeyboardElement.addEventListener("compositionend",e=>this.handleTextInput(e,!0)),this.inputStatusKeyboardElement.addEventListener("paste",e=>{var t;let s=(e.clipboardData||(null==(t=window)?void 0:t.clipboardData)).getData("text");this.handleTextInput({data:s},!0)}),null==(e=document.querySelector(this.fullscreenElementId))||e.appendChild(this.inputStatusKeyboardElement)}handleTextInput(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(!e.isComposing||t)&&this.dataChannelSend(r.INPUT,{msg:e.data})}updateStatusInfo(e){let t="function"==typeof e?e(this.status):{...this.status,...e};this.status=(0,g.m)(t),t.configKeyboard&&t.configKeyboard!==this.status.configKeyboard&&this.hookEvent(y.KEYBOARD_DATA_UPDATE,{data:t.configKeyboard})}handleCompassTask(){this.compassInterval||(this.compassInterval=setInterval(()=>{this.activeCompassMap.forEach((e,t)=>{let s=function(e,t){let{hotPress:s,deviceCoord:i,fivePoints:n,prevHotPressSize:a}=e,o=i||{x:n.centerX,y:n.centerY};if(a!==s.size){let{centerX:e,centerY:t}=n;o={x:e,y:t}}let r=t?b.UP:b.RIGHT,c=t?b.DOWN:b.LEFT,l=t?b.LEFT:b.UP,u=t?b.RIGHT:b.DOWN;return s.has(r)&&(o=o.x<n.topX?{x:o.x+=10,y:o.y}:o),s.has(c)&&(o=o.x>n.bottomX?{x:o.x-=10,y:o.y}:o),s.has(l)&&(o=o.y>n.leftY?{x:o.x,y:o.y-=10}:o),s.has(u)&&(o=o.y<n.rightY?{x:o.x,y:o.y+=10}:o),o}(e,this.status.isHorizontal);this.activeCompassMap.set(t,{...e,prevHotPressSize:e.hotPress.size,deviceCoord:s}),this.consumeLocusData(t,{x:s.x,y:s.y,status:_.MOVE})}),!this.activeCompassMap.size&&this.compassInterval&&(clearInterval(this.compassInterval),this.compassInterval=null)},this.compassMoveInterval))}setControlLayerElement(e){if(e){let t=this.resizeObserverRect();null==t||t.observe(e),this.isRegisteredKeyboardListener||(this.listenerToggleInputStatus(),this.keydownListener=this.keydown.bind(this),this.keyupListener=this.keyup.bind(this),this.wheelListener=this.wheel.bind(this),window.addEventListener("keydown",this.keydownListener,!0),window.addEventListener("keyup",this.keyupListener,!0),e.addEventListener("wheel",this.wheelListener,{passive:!1}),this.isRegisteredKeyboardListener=!0)}}checkComposeIsActive(e){if(!e)return!1;let t=0;return e.forEach(e=>{this.activeKeyMap.has(e)&&(t+=1)}),t===e.length}triggerSystemKey(e){this.dataChannelSend(r.SYSTEM_KEY,{type:"0",x:e})}wheel(e){if(!this.activeKeyMap.size||this.isInZoomStatus){if(e.preventDefault(),this.wheelStatus.timer&&clearTimeout(this.wheelStatus.timer),this.wheelStatus.timer=setTimeout(()=>{this.wheelStatus.isWheeling=!1,this.consumeLocusData("system-wheel-scroll",{status:_.UP,...this.wheelStatus.prevXY})},100),!this.wheelStatus.isWheeling){this.wheelStatus.isWheeling=!0;let[{x:t,y:s}]=C(e,this.rect,this.status.isHorizontal);this.status.isHorizontal&&(s+=e.deltaY),this.isInZoomStatus||this.consumeLocusData("system-wheel-scroll",{status:_.DOWN,x:t,y:s}),this.wheelStatus.startXY={x:t,y:s},this.wheelStatus.prevXY={x:t,y:s},this.wheelStatus.zoom1XY={x:t,y:e.deltaY>0?s+400:s},this.wheelStatus.zoom2XY={x:t,y:e.deltaY>0?s-400:s};return}if(this.isInZoomStatus){let t=0;for(;t<10;)e.deltaY<0?(this.wheelStatus.zoom1XY.y+=2,this.wheelStatus.zoom2XY.y-=2):(this.wheelStatus.zoom1XY.y-=2,this.wheelStatus.zoom2XY.y+=2),this.consumeLocusData("zoom-by-wheel-1",{status:_.MOVE,...this.wheelStatus.zoom1XY}),this.consumeLocusData("zoom-by-wheel-2",{status:_.MOVE,...this.wheelStatus.zoom2XY}),t+=1}else{let t=0;for(;t<10;){let s=e.deltaY>0?2*t:-2*t;this.status.isHorizontal?this.wheelStatus.prevXY.x+=s:this.wheelStatus.prevXY.y+=s,this.consumeLocusData("system-wheel-scroll",{status:_.MOVE,...this.wheelStatus.prevXY}),t+=1}}}}keydown(e){if(!e.isComposing&&229!==e.keyCode)if(this.hookEvent(y.KEYBOARD_DOWN,{event:e}),this.status.isInputStatus){let t=["Delete","Backspace","Enter"].findIndex(t=>t===e.key);if(t<0)return;this.triggerSystemKey(t>1?S.ENTER:S.DELETE)}else{var t;let s=null==(t=this.status.configKeyboard)?void 0:t.logic[e.code];if(s&&s.length){if(e.preventDefault(),this.activeKeyMap.has(e.code))return;this.activeKeyMap.add(e.code),s.forEach(t=>{var i;let n=null==(i=this.status.configKeyboard)?void 0:i.interactive[t.interactive];if(!t.isCompose||this.checkComposeIsActive(t.composition)){if(n){let{width:e,x:s,y:i}=n;switch(t.patch){case I.TOUCH:{let{centerX:n,centerY:a}=D(e,s,i,this.rect.width,this.rect.height,this.status.isHorizontal);this.consumeLocusData(t.interactive,{status:_.DOWN,x:n,y:a});break}case I.COMPASS:{let n=this.activeCompassMap.get(t.interactive);if(!n){let a=function(e,t,s,i,n,a){let{deviceYRadius:o,deviceXRadius:r,centerX:c,centerY:l}=D(e,t,s,i,n,a);return{centerX:c,centerY:l,leftX:c,leftY:l-o,rightX:c,rightY:l+o,topX:c+r,topY:l,bottomX:c-r,bottomY:l}}(e,s,i,this.rect.width,this.rect.height,this.status.isHorizontal);n={fivePoints:a,hotPress:new Set,prevHotPressSize:0},this.consumeLocusData(t.interactive,{status:_.DOWN,x:a.centerX,y:a.centerY})}n.hotPress.add(t.direction),this.activeCompassMap.set(t.interactive,n),this.handleCompassTask();break}case I.ZOOM:this.isInZoomStatus=!0,this.consumeLocusData("zoom-by-wheel-1",{status:_.DOWN,x:s,y:i})}}this.hookEvent(y.PRESET_KEYBOARD_DOWN,{code:e.code,uiId:s.map(e=>e.interactive),activeKeyMap:this.activeKeyMap})}})}}}keyup(e){var t;if(this.hookEvent(y.KEYBOARD_UP,{event:e}),this.status.isInputStatus)return;let s=null==(t=this.status.configKeyboard)?void 0:t.logic[e.code];s&&s.length&&(e.preventDefault(),this.activeKeyMap.delete(e.code),s.forEach(e=>{var t;let s=null==(t=this.status.configKeyboard)?void 0:t.interactive[e.interactive];if(s){let{x:t,y:i,width:n}=s;if(e.patch===I.TOUCH){let{centerX:s,centerY:a}=D(n,t,i,this.rect.width,this.rect.height,this.status.isHorizontal);this.consumeLocusData(e.interactive,{status:_.UP,x:s,y:a})}else if(e.patch===I.COMPASS){let t=this.activeCompassMap.get(e.interactive);t&&(t.hotPress.delete(e.direction),t.hotPress.size?this.activeCompassMap.set(e.interactive,{...t}):(this.activeCompassMap.delete(e.interactive),this.consumeLocusData(e.interactive,{status:_.UP,x:t.fivePoints.centerX,y:t.fivePoints.centerY})))}else e.patch===I.ROTATION?(this.isScreenFollowMouseStatus.working=!this.isScreenFollowMouseStatus.working,this.isScreenFollowMouseStatus.key=e.interactive,this.consumeLocusData(e.interactive,{status:this.isScreenFollowMouseStatus.working?_.DOWN:_.UP,x:t,y:i}),this.hookEvent(y.TOGGLE_SCREEN_FOLLOW_SCREEN_STATUS,{status:this.isScreenFollowMouseStatus.working})):e.patch===I.ZOOM&&(this.isInZoomStatus=!1,this.consumeLocusData("zoom-by-wheel-1",{status:_.UP,...this.wheelStatus.zoom1XY}),this.consumeLocusData("zoom-by-wheel-2",{status:_.UP,...this.wheelStatus.zoom2XY}))}}),this.hookEvent(y.PRESET_KEYBOARD_UP,{code:e.code,uiId:s.map(e=>e.interactive),activeKeyMap:this.activeKeyMap}))}resizeObserverRect(){try{return new ResizeObserver(e=>{window.requestAnimationFrame(()=>{if(Array.isArray(e)&&e.length){for(let t of e)if(t.target){let{left:e,top:s,width:i,height:n}=t.target.getBoundingClientRect();this.rect={left:e,top:s,width:i,height:n},this.hookEvent(y.CONTROL_RECT_RESIZE,this.rect)}}})})}catch(e){}}down(e){this.isPress=!0;let[{x:t,y:s,id:i}]=C(e,this.rect,this.status.isHorizontal),n={type:w.DOWN,x:t,y:s};this.consumeLocusData("touch-".concat(i||0),{status:_.DOWN,x:t,y:s}),this.hookEvent(y.MULTI_TOUCH,n)}move(e){let{working:t,key:s}=this.isScreenFollowMouseStatus;if(this.isPress||t){let i=C(e,this.rect,this.status.isHorizontal);t&&!this.activeKeyMap.size&&this.consumeLocusData(s,{status:_.DOWN,x:i[0].x,y:i[0].y}),i.forEach(e=>{let i=t?s:"touch-".concat(e.id||0);this.consumeLocusData(i,{status:_.MOVE,x:e.x,y:e.y})}),this.hookEvent(y.MOVE,i)}}up(e){this.isPress=!1;let[{x:t,y:s,id:i}]=C(e,this.rect,this.status.isHorizontal),n={type:w.UP,x:t,y:s};this.consumeLocusData("touch-".concat(i||0),{status:_.UP,x:t,y:s}),this.hookEvent(y.MULTI_TOUCH,n)}interactiveUnbindLogic(e,t,s){e.forEach(e=>{if(this.status.configKeyboard&&this.status.configKeyboard.logic[e]){var i;this.status.configKeyboard.logic[e]=null==(i=this.status.configKeyboard.logic[e])?void 0:i.filter(e=>void 0===s?e.interactive!==t:e.interactive===t&&Number(s)!==Number(e.direction)),this.status.configKeyboard.logic[e].length||delete this.status.configKeyboard.logic[e]}})}interactiveBindLogic(e,t,s,i){e.forEach((n,a)=>{if(this.status.configKeyboard){let o,r=this.status.configKeyboard.logic[n]||[],c=e.length>0&&t!==I.COMPASS;c&&(o=e.filter(e=>e!==n));let l={patch:t,interactive:s,isCompose:c,direction:i?Number(i):void 0,composition:o};t===I.COMPASS&&(l.direction=a),this.status.configKeyboard.logic[n]=[...r,l]}})}translateControlAreaRectData(e){if((null==e?void 0:e.x)&&(null==e?void 0:e.y)){let{x:t,y:s}=A(e.x,e.y,this.rect.width,this.rect.height);e={...e,x:t,y:s}}return(null==e?void 0:e.width)&&(null==e?void 0:e.height)&&(e={...e,width:Math.round(e.width/this.rect.width*1e3),height:Math.round(e.height/this.rect.width*1e3)}),e}addControlArea(e){if(!this.status.configKeyboard)return;let t=L(this.status.configKeyboard.interactive);e={...e,...this.translateControlAreaRectData(e)},this.status.configKeyboard.interactive[t]=e,this.interactiveBindLogic(e.code,e.type,t),this.hookEvent(y.KEYBOARD_DATA_UPDATE,{data:this.status.configKeyboard})}getSafeInteractiveCode(e,t,s){var i,n;if(!(null==(n=this.status.configKeyboard)||null==(i=n.interactive)?void 0:i[t]))return e;let a={...this.status.configKeyboard.interactive[t]};if(void 0===s||a.type!==I.COMPASS||"object"!=typeof a.name)return e;{let t=[...a.code];return t[Number(s)]=e[0],t}}getSafeInteractiveName(e,t,s){var i,n;let a=e.join("+").toLocaleUpperCase();if(!(null==(n=this.status.configKeyboard)||null==(i=n.interactive)?void 0:i[t]))return a;let o={...this.status.configKeyboard.interactive[t]};return void 0!==s&&o.type===I.COMPASS&&"object"==typeof o.name?{...o.name,[s]:a[0].toLocaleUpperCase()}:a}setControlArea(e,t){if(!this.status.configKeyboard)return;let s={...this.status.configKeyboard.interactive[t]};s&&((e={...e,...this.translateControlAreaRectData(e)}).code&&(this.interactiveUnbindLogic(s.code,t,e.direction),this.interactiveBindLogic(e.code,s.type,t,e.direction)),this.status.configKeyboard.interactive[t]={...s,...e},this.hookEvent(y.KEYBOARD_DATA_UPDATE,{data:this.status.configKeyboard}))}deleteControlArea(e){if(!this.status.configKeyboard)return;let t=this.status.configKeyboard.interactive[e];this.interactiveUnbindLogic(t.code,e),delete this.status.configKeyboard.interactive[e],this.hookEvent(y.KEYBOARD_DATA_UPDATE,{data:this.status.configKeyboard})}destroy(){this.compassInterval&&clearInterval(this.compassInterval),this.keydownListener&&window.removeEventListener("keydown",this.keydownListener,!0),this.keyupListener&&window.removeEventListener("keyup",this.keyupListener,!0),this.keydownListener=null,this.keyupListener=null,this.isRegisteredKeyboardListener=!1}constructor(e,t,s){super(),this.isPress=!1,this.isRegisteredKeyboardListener=!1,this.status={isHorizontal:!1,isInputStatus:!1,isFreezeControl:!1,configKeyboard:{logic:{},interactive:{}}},this.rect={left:0,top:0,width:0,height:0},this.prevInputText="",this.inputStatusKeyboardElement=null,this.fullscreenElementId="#fullscreen-element",this.activeKeyMap=new Set,this.activeCompassMap=new Map,this.keydownListener=null,this.keyupListener=null,this.wheelListener=null,this.compassMoveInterval=3,this.compassInterval=null,this.locusList=new Map,this.wheelStatus={isWheeling:!1,startXY:{x:0,y:0},prevXY:{x:0,y:0},zoom1XY:{x:0,y:0},zoom2XY:{x:0,y:0},timer:null},this.isScreenFollowMouseStatus={working:!1,key:""},this.isInZoomStatus=!1,this.wsSend=e,this.wsEffect=t,this.dataChannelSend=s}}function M(e,t,s){let i=new R(e,t,s);return{control:i,down:i.down.bind(i),move:i.move.bind(i),up:i.up.bind(i),setControlLayerElement:i.setControlLayerElement.bind(i),triggerSystemKey:i.triggerSystemKey.bind(i),destroy:i.destroy.bind(i),effect:i.effect.bind(i),getStatusInfo:i.getStatusInfo.bind(i),getVideoRect:i.getVideoRect.bind(i),updateStatusInfo:i.updateStatusInfo.bind(i),clearEffectList:i.clearEffectList.bind(i),addControlArea:i.addControlArea.bind(i),setControlArea:i.setControlArea.bind(i),deleteControlArea:i.deleteControlArea.bind(i),getSafeInteractiveCode:i.getSafeInteractiveCode.bind(i),getSafeInteractiveName:i.getSafeInteractiveName.bind(i)}}function x(e){let{deviceId:t,ip:s,gameInfo:i,...n}=e,{token:a,uid:o}=n,r=JSON.stringify({deviceId:t,token:a,uid:o}),u=T()?l.MOBILE:l.PC;return{authparams:r,quality:c.HD,sys_locale:"en-US",type:u,user_agent:window.navigator.userAgent,cloudgame_cfg:i,...n}}},81997:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var i=s(6379),n=s(42305),a=s(81500),o=s(1098),r=s(3437),c=s(39910);function l(e){var t,s,l,u;let{data:d,children:h,className:f,playButton:p,...m}=e,{photo:v,icon:E}=function(e){var t,s,i,n;try{let t=null==(i=JSON.parse((null==(n=e.easyfunGame)?void 0:n.photos)||"[]"))||null==(s=i[0])?void 0:s.image;if(t)return{photo:t}}catch(e){}return{icon:(null==(t=e.easyfunGame)?void 0:t.icon)||e.iconUrl||""}}(d);return d.easyfunGame&&(0,i.jsxs)(c.A,{className:(0,n.A)("absolute-top-start size-full of-hidden",f),id:"cloud-game-poster",...m,children:[(v||E)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.default,{src:v||E||"",alt:(0,r.w)(null==d||null==(t=d.easyfunGame)?void 0:t.gameName),width:1280,height:720,quality:1,className:"absolute-top-start aspect-16/9 size-full bg-black-1",fetchPriority:"high",loading:"eager"}),(0,i.jsx)(a.default,{src:v||E||"",alt:(0,r.w)(null==d||null==(s=d.easyfunGame)?void 0:s.gameName),width:1280,height:720,className:"absolute-top-start z-1 aspect-16/9 size-full",loading:"lazy"})]}),(0,i.jsxs)("div",{className:(0,n.A)("relative z-2 size-full flex-center flex-col gap-3 bg-black-1",v&&"bg-op-70",E&&"bg-op-50"),children:[(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)(o.default,{src:d.easyfunGame.icon,alt:(0,r.w)(null==d||null==(l=d.easyfunGame)?void 0:l.gameName),width:100,height:100,className:"mb-4 aspect-square size-25 rd-4"}),(0,i.jsx)("h1",{className:"mb-8 text-6 c-white-1 fw-600 lh-6",children:null==d||null==(u=d.easyfunGame)?void 0:u.gameName}),p]}),h]})]})}},84459:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n});var i=s(94907);function n(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:768,[s,n]=(0,i.useState)(e),[a,o]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=()=>{let e=navigator.userAgent,s=window.matchMedia("(max-width: ".concat(t,"px)")).matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),i=/iPad|iPhone|iPod/.test(e),a="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;n(s),o(i||a)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),{isMobile:s,isIOS:a}}},86800:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var i=s(2285),n=s(94907),a=s(64510),o=s(68878);class r{effect(e,t){t.forEach(t=>{let s=this.effectList.get(t)||[];this.effectList.set(t,[...s,{callback:e}])})}hookEvent(e,t){(this.effectList.get(e)||[]).forEach(s=>{s.callback(t,e)})}getEffect(e){return this.effectList.get(e)||[]}clearEffectList(){this.effectList.clear()}constructor(){this.effectList=new Map}}var c=s(16983);class l extends r{setParams(e){return this.url=e.url,this}connect(){return new Promise((e,t)=>{this.ws=new WebSocket(this.url),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{e(this.ws),this.ws&&(this.ws.onmessage=e=>{let t=JSON.parse(e.data);this.hookEvent(t.code,t)},this.ws.onerror=t)},this.ws.onclose=()=>{this.hookEvent(c.o.关闭,{}),this.clearEffectList(),console.log("backend business wss close")},this.ws.onerror=e=>{console.log("backend business wss error",e)}})}send(e){var t;null==(t=this.ws)||t.send(JSON.stringify({type:e}))}close(){var e;null==(e=this.ws)||e.close(),console.log("business wss close")}constructor(...e){super(...e),this.ws=null,this.url=""}}var u=s(76518);function d(e){let{children:t,data:s}=e,{start:r,done:d,stop:h}=function(){let e=(0,n.useRef)(0),t=(0,n.useRef)(null),s=(0,i.yF)((i,n)=>{t.current=requestAnimationFrame(()=>{e.current+=100;let t=1-Math.exp(-1*e.current/8e3);n(a.o2,t),t<1&&s()})}),o=(0,i.yF)((e,s)=>{t.current&&(cancelAnimationFrame(t.current),t.current=null)}),r=(0,i.yF)((t,i)=>{o(),i(a.o2,0),e.current=0,s()}),c=(0,i.yF)((e,t)=>{o(),t(a.o2,1)});return(0,n.useEffect)(()=>()=>{o()},[]),{start:r,done:c,stop:o}}(),f=(0,i.yF)((e,t)=>{t(a.vB,s.easyfunGame);let i=function(){let e=new l;return{getWSInstance:()=>e.ws,close:e.close.bind(e),send:e.send.bind(e),setParams:e.setParams.bind(e),connect:e.connect.bind(e),effect:e.effect.bind(e),clearEffectList:e.clearEffectList.bind(e),getEffect:e.getEffect.bind(e),hookEvent:e.hookEvent.bind(e)}}(),n=(0,u.gm)(),o=(0,u.UO)(n.send,n.effect),c=(0,u.Sq)(n.send,n.effect,o.dataChannelSend);t(a.Lp,{businessWss:i,wss:n,rtc:o,control:c}),t(a.ii,{start:r,done:d,stop:h})}),p=(0,i.yF)((e,t)=>{t(a.vB,{});let{businessWss:s,wss:i,rtc:n,control:r}=e(a.Lp);s.hookEvent(c.o.关闭,{}),s.close(),s.clearEffectList(),i.close(),i.clearEffectList(),n.close(),n.clearEffectList(),r.destroy(),r.clearEffectList(),t(a.n6,o.fJ.空闲),t(a.X0,{gameId:"",isReconnect:!1,device:{}}),t(a.Qp,{gameId:"",businessWssLink:"",isReconnect:!1}),t(a.o2,0)});return(0,n.useEffect)(()=>(f(),()=>{p()}),[]),t}},97587:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});let i=(0,s(94907).createContext)({value:{visible:!1,props:{}},setValue:e=>{}})}}]);